

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Rolling Cross Validation for Monthly CPI Forecasting &#8212; SajjadPSavoji/forecasting-bootcamp</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=__G_ANALYTICS_ID__"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', '__G_ANALYTICS_ID__');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'demos/demo3_rolling_cv_prophet';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Univariate and Univariate With Exogenous Features Forecasting Demo Notebooks" href="README.html" />
    <link rel="prev" title="Data Loading" href="demo2_pytorch_forecasting-NBEATS-CPI.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
    
    
      
    
    
    <img src="https://vectorinstitute.ai/wp-content/uploads/2022/11/logo-vector-institute-full-colour-01.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="https://vectorinstitute.ai/wp-content/uploads/2022/11/logo-vector-institute-full-colour-01.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Forecasting Bootcamp
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../datasets/datasets_intro.html">Datasets intro</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../datasets/can_climate_data/data_explore.html">Load weather data and station metadata</a></li>




<li class="toctree-l2"><a class="reference internal" href="../datasets/m5/load_m5_dataset.html">M5 Data Preparation</a></li>

</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="demo1_prophet_neuralprophet_testset.html">Data Loading</a></li>





<li class="toctree-l1"><a class="reference internal" href="../external_demos/m5-competition-eda-models.html">Introduction</a></li>







<li class="toctree-l1 has-children"><a class="reference internal" href="../intro_to_forecasting/intro_time_series.html">Intro time series</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro_to_forecasting/intro_time_series_2.html">Intro time series 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro_to_forecasting/README.html">Readme</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../multivariate_demos/deepar_electricty.html">Deepar electricty</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../multivariate_demos/nbeats_electricity.html">Nbeats electricity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multivariate_demos/nhits_quantile.html">Nhits quantile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multivariate_demos/README.html">Readme</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../multivariate_lstf_demos/autoformer_traffic.html">Autoformer traffic</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../multivariate_lstf_demos/nhits_traffic.html">Nhits traffic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multivariate_lstf_demos/README.html">Readme</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/SajjadPSavoji/forecasting-bootcamp/booklet?urlpath=lab/tree/./demos/demo3_rolling_cv_prophet.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/SajjadPSavoji/forecasting-bootcamp/blob/booklet/./demos/demo3_rolling_cv_prophet.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/SajjadPSavoji/forecasting-bootcamp" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SajjadPSavoji/forecasting-bootcamp/edit/booklet/./demos/demo3_rolling_cv_prophet.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SajjadPSavoji/forecasting-bootcamp/issues/new?title=Issue%20on%20page%20%2Fdemos/demo3_rolling_cv_prophet.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/demos/demo3_rolling_cv_prophet.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Rolling Cross Validation for Monthly CPI Forecasting</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Rolling Cross Validation for Monthly CPI Forecasting</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data-from-file">Load Data From File</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-setup">Experiment Setup</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-function-for-prophet-data-loading">Helper Function for Prophet Data Loading</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-evaluation-metrics">Define Evaluation Metrics</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-fit-and-evaluate-models-for-all-cpi-categories-validation">Define Functions to Fit and Evaluate Models for All CPI Categories (Validation)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-model-fitting-and-evaluation">Run model fitting and evaluation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-raw-evaluation-metrics">View Raw Evaluation Metrics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#collect-mean-validation-metrics-over-cutoff-dates-and-save-to-file">Collect Mean Validation Metrics Over Cutoff Dates and Save to File</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#save-validation-forecasts-to-file-optional-for-ensembling">Save Validation Forecasts to File (Optional, For Ensembling)</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="rolling-cross-validation-for-monthly-cpi-forecasting">
<h1>Rolling Cross Validation for Monthly CPI Forecasting<a class="headerlink" href="#rolling-cross-validation-for-monthly-cpi-forecasting" title="Permalink to this heading">#</a></h1>
<p>In this notebook, using Prophet, we provide a template for a rolling cross validation experiment on a CPI forecasting task. The purpose of rolling cross validation, in this context, is to evaluate how well the strategy of consuming all available data for model training would have worked in retrospect. This can be useful in situations where data are scarce and where it is desirable to train models using the most recently available data possible.</p>
<p>To do this, we will refit a Prophet model using data up to several cutoff dates. In this notebook, we use 6 cutoff dates that are all one year apart. This code has been adapted from Vector’s contribution to the 2022 edition of Canada’s Food Price Report, with code available <a class="reference external" href="https://github.com/VectorInstitute/foodprice-forecasting">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
<span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.precision&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">prophet</span> <span class="kn">import</span> <span class="n">Prophet</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Set the output path corresponding to the experiment. The ensembling experiment will</span>
<span class="sd">look for specific output files in the output directory corresponding to forecasts,</span>
<span class="sd">e.g.: ./output/prophet_202110/forecasts_2015-07-01.csv</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="s2">&quot;./rolling_cv_output/prophet_experiment&quot;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_path</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;./rolling_cv_output&quot;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;./rolling_cv_output&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-data-from-file">
<h1>Load Data From File<a class="headerlink" href="#load-data-from-file" title="Permalink to this heading">#</a></h1>
<p>In this demo, we will use Prophet to produce univarate forecasts for each of the 9 major Canadian food price categories listed in the columns below. The dataset is part of a larger dataset that includes many variables from the <a class="reference external" href="https://fred.stlouisfed.org/">FRED</a> database. These variables are not used in this demo, but could certainly be used in an exploration of more sophisticated global or multivariate forecasting models!</p>
<p>If we’re using Colab, we mount our Google Drive which should have the bootcamp datasets in it already (See Github Repo Readme for instructions).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">()):</span>
    <span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
    <span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mounted at /content/drive
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">data_dir</span></code> should be changed to reflect the address of the cpi_forecasting dataset. For example, if using Colab, the dataset may be housed in <code class="docutils literal notranslate"><span class="pre">/content/drive/MyDrive/Forecasting</span> <span class="pre">Bootcamp</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_dir</span> <span class="o">=</span> <span class="s2">&quot;/content/drive/MyDrive/bootcamp_datasets/cpi_forecasting&quot;</span>

<span class="c1"># Read food price categories from the text file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/foodprice_categories.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">foodprice_categories</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>

<span class="c1"># Read the main data file</span>
<span class="n">foodprice_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/all_data.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">foodprice_df</span> <span class="o">=</span> <span class="n">foodprice_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">foodprice_df</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
<span class="n">foodprice_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">

  <div id="df-15b5c14d-e446-41b7-ab1c-331bcc556524">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bakery and cereal products (excluding baby food)</th>
      <th>Dairy products and eggs</th>
      <th>Fish, seafood and other marine products</th>
      <th>Food purchased from restaurants</th>
      <th>Food</th>
      <th>Fruit, fruit preparations and nuts</th>
      <th>Meat</th>
      <th>Other food products and non-alcoholic beverages</th>
      <th>Vegetables and vegetable preparations</th>
      <th>DEXCAUS</th>
      <th>...</th>
      <th>XTIMVA01CAM657S</th>
      <th>XTIMVA01CAM659S</th>
      <th>XTIMVA01CAM664N</th>
      <th>XTIMVA01CAM664S</th>
      <th>XTIMVA01CAM667S</th>
      <th>XTNTVA01CAM664N</th>
      <th>XTNTVA01CAM664S</th>
      <th>XTNTVA01CAM667S</th>
      <th>TOTALNS</th>
      <th>TOTALSL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1986-01-01</th>
      <td>69.3</td>
      <td>70.9</td>
      <td>60.6</td>
      <td>59.1</td>
      <td>67.3</td>
      <td>76.0</td>
      <td>65.1</td>
      <td>77.5</td>
      <td>76.0</td>
      <td>1.392</td>
      <td>...</td>
      <td>3.644</td>
      <td>12.051</td>
      <td>9.368e+09</td>
      <td>9.496e+09</td>
      <td>6.749e+09</td>
      <td>6.906e+08</td>
      <td>1.052e+09</td>
      <td>7.479e+08</td>
      <td>607.369</td>
      <td>605.703</td>
    </tr>
    <tr>
      <th>1986-02-01</th>
      <td>70.3</td>
      <td>70.8</td>
      <td>61.3</td>
      <td>59.1</td>
      <td>66.9</td>
      <td>77.6</td>
      <td>64.2</td>
      <td>78.1</td>
      <td>68.4</td>
      <td>1.392</td>
      <td>...</td>
      <td>1.965</td>
      <td>16.745</td>
      <td>9.495e+09</td>
      <td>9.632e+09</td>
      <td>6.881e+09</td>
      <td>-9.880e+07</td>
      <td>1.539e+08</td>
      <td>1.099e+08</td>
      <td>605.807</td>
      <td>610.678</td>
    </tr>
    <tr>
      <th>1986-03-01</th>
      <td>70.6</td>
      <td>71.1</td>
      <td>61.3</td>
      <td>59.3</td>
      <td>67.0</td>
      <td>79.2</td>
      <td>64.2</td>
      <td>78.6</td>
      <td>66.2</td>
      <td>1.392</td>
      <td>...</td>
      <td>-11.565</td>
      <td>1.655</td>
      <td>8.803e+09</td>
      <td>8.529e+09</td>
      <td>6.085e+09</td>
      <td>9.138e+08</td>
      <td>9.079e+08</td>
      <td>6.478e+08</td>
      <td>606.799</td>
      <td>613.377</td>
    </tr>
    <tr>
      <th>1986-04-01</th>
      <td>71.3</td>
      <td>71.0</td>
      <td>61.4</td>
      <td>59.7</td>
      <td>67.7</td>
      <td>82.2</td>
      <td>63.6</td>
      <td>79.5</td>
      <td>71.1</td>
      <td>1.392</td>
      <td>...</td>
      <td>13.334</td>
      <td>10.821</td>
      <td>1.034e+10</td>
      <td>9.569e+09</td>
      <td>6.897e+09</td>
      <td>3.470e+08</td>
      <td>6.563e+08</td>
      <td>4.730e+08</td>
      <td>614.367</td>
      <td>619.658</td>
    </tr>
    <tr>
      <th>1986-05-01</th>
      <td>71.2</td>
      <td>71.4</td>
      <td>61.9</td>
      <td>59.9</td>
      <td>68.2</td>
      <td>83.5</td>
      <td>64.0</td>
      <td>79.8</td>
      <td>75.3</td>
      <td>1.377</td>
      <td>...</td>
      <td>-4.236</td>
      <td>6.160</td>
      <td>9.598e+09</td>
      <td>9.091e+09</td>
      <td>6.605e+09</td>
      <td>7.013e+08</td>
      <td>6.893e+08</td>
      <td>5.008e+08</td>
      <td>621.915</td>
      <td>625.820</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2021-06-01</th>
      <td>157.7</td>
      <td>145.3</td>
      <td>146.2</td>
      <td>163.9</td>
      <td>156.8</td>
      <td>144.5</td>
      <td>176.7</td>
      <td>142.2</td>
      <td>153.4</td>
      <td>1.203</td>
      <td>...</td>
      <td>-1.087</td>
      <td>31.561</td>
      <td>5.159e+10</td>
      <td>4.979e+10</td>
      <td>4.075e+10</td>
      <td>3.661e+09</td>
      <td>3.111e+09</td>
      <td>2.546e+09</td>
      <td>4259.604</td>
      <td>4307.137</td>
    </tr>
    <tr>
      <th>2021-07-01</th>
      <td>157.9</td>
      <td>146.4</td>
      <td>146.6</td>
      <td>165.2</td>
      <td>157.6</td>
      <td>141.7</td>
      <td>180.9</td>
      <td>141.9</td>
      <td>154.8</td>
      <td>1.240</td>
      <td>...</td>
      <td>1.990</td>
      <td>18.580</td>
      <td>5.106e+10</td>
      <td>5.205e+10</td>
      <td>4.156e+10</td>
      <td>3.780e+08</td>
      <td>1.129e+09</td>
      <td>9.018e+08</td>
      <td>4276.202</td>
      <td>4323.730</td>
    </tr>
    <tr>
      <th>2021-08-01</th>
      <td>158.5</td>
      <td>148.3</td>
      <td>146.8</td>
      <td>165.9</td>
      <td>158.0</td>
      <td>142.5</td>
      <td>182.1</td>
      <td>141.7</td>
      <td>152.2</td>
      <td>1.251</td>
      <td>...</td>
      <td>-2.312</td>
      <td>14.723</td>
      <td>5.245e+10</td>
      <td>5.115e+10</td>
      <td>4.060e+10</td>
      <td>1.300e+09</td>
      <td>2.674e+09</td>
      <td>2.123e+09</td>
      <td>4316.303</td>
      <td>4337.489</td>
    </tr>
    <tr>
      <th>2021-09-01</th>
      <td>158.1</td>
      <td>148.0</td>
      <td>147.1</td>
      <td>165.9</td>
      <td>158.5</td>
      <td>141.5</td>
      <td>184.8</td>
      <td>144.3</td>
      <td>150.0</td>
      <td>1.262</td>
      <td>...</td>
      <td>-3.461</td>
      <td>8.557</td>
      <td>5.080e+10</td>
      <td>4.965e+10</td>
      <td>3.920e+10</td>
      <td>1.561e+09</td>
      <td>2.277e+09</td>
      <td>1.798e+09</td>
      <td>4346.662</td>
      <td>4367.402</td>
    </tr>
    <tr>
      <th>2021-10-01</th>
      <td>159.3</td>
      <td>146.6</td>
      <td>149.3</td>
      <td>167.1</td>
      <td>159.2</td>
      <td>141.7</td>
      <td>187.1</td>
      <td>144.4</td>
      <td>149.4</td>
      <td>1.266</td>
      <td>...</td>
      <td>-3.461</td>
      <td>8.557</td>
      <td>5.080e+10</td>
      <td>4.965e+10</td>
      <td>3.920e+10</td>
      <td>1.561e+09</td>
      <td>2.277e+09</td>
      <td>1.798e+09</td>
      <td>4346.662</td>
      <td>4367.402</td>
    </tr>
  </tbody>
</table>
<p>430 rows × 332 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-15b5c14d-e446-41b7-ab1c-331bcc556524')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>



    <div id="df-97f87c7d-335d-44c3-a1b6-a39634e31038">
      <button class="colab-df-quickchart" onclick="quickchart('df-97f87c7d-335d-44c3-a1b6-a39634e31038')"
              title="Suggest charts."
              style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>
    </div>

<style>
  .colab-df-quickchart {
    background-color: #E8F0FE;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: #1967D2;
    height: 32px;
    padding: 0 0 0 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: #E2EBFA;
    box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: #174EA6;
  }

  [theme=dark] .colab-df-quickchart {
    background-color: #3B4455;
    fill: #D2E3FC;
  }

  [theme=dark] .colab-df-quickchart:hover {
    background-color: #434B5C;
    box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
    filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
    fill: #FFFFFF;
  }
</style>

    <script>
      async function quickchart(key) {
        const containerElement = document.querySelector('#' + key);
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      }
    </script>

      <script>

function displayQuickchartButton(domScope) {
  let quickchartButtonEl =
    domScope.querySelector('#df-97f87c7d-335d-44c3-a1b6-a39634e31038 button.colab-df-quickchart');
  quickchartButtonEl.style.display =
    google.colab.kernel.accessAllowed ? 'block' : 'none';
}

        displayQuickchartButton(document);
      </script>
      <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-15b5c14d-e446-41b7-ab1c-331bcc556524 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-15b5c14d-e446-41b7-ab1c-331bcc556524');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="experiment-setup">
<h1>Experiment Setup<a class="headerlink" href="#experiment-setup" title="Permalink to this heading">#</a></h1>
<p>Load the rolling cross validation cutoff dates specified in a file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read cutoff dates from the text file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/cutoff_dates.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">cutoff_dates</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>

<span class="c1"># Convert the dates to pandas Timestamp objects</span>
<span class="n">cutoff_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">cutoff_dates</span><span class="p">)</span>

<span class="c1"># Display the list of cutoff dates</span>
<span class="n">cutoff_dates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2015-07-01&#39;, &#39;2016-07-01&#39;, &#39;2017-07-01&#39;, &#39;2018-07-01&#39;,
               &#39;2019-07-01&#39;, &#39;2020-07-01&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
<p>Use the cutoff dates to determine collections of training and validation periods that correspond to the cutoff date. In this case, the task is to train using all data available up to the cutoff date, and to evaluate forecasts on the following 18 months only. This is a direct reflection of this specific use case, where we are only ever interested in producing 18-month forecasts on an annual basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_train_dates</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">sim_valid_dates</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">cutoff_dates</span><span class="p">:</span>
    <span class="n">sim_train_dates</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">foodprice_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">foodprice_df</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="n">date</span><span class="p">]</span>
    <span class="n">sim_valid_dates</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">foodprice_df</span><span class="o">.</span><span class="n">index</span><span class="p">[(</span><span class="n">foodprice_df</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">foodprice_df</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">months</span><span class="o">=</span><span class="mi">18</span><span class="p">)))]</span>
</pre></div>
</div>
</div>
</div>
<section id="helper-function-for-prophet-data-loading">
<h2>Helper Function for Prophet Data Loading<a class="headerlink" href="#helper-function-for-prophet-data-loading" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_prophet_df</span><span class="p">(</span><span class="n">foodprice_df</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">dates</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">foodprice_df</span><span class="p">[</span><span class="n">food_category</span><span class="p">][</span><span class="n">dates</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;REF_DATE&#39;</span><span class="p">:</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span><span class="s1">&#39;ds&#39;</span><span class="p">,</span> <span class="n">food_category</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-evaluation-metrics">
<h2>Define Evaluation Metrics<a class="headerlink" href="#define-evaluation-metrics" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rmse</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;r2_score&#39;</span><span class="p">:</span> <span class="n">r2_score</span><span class="p">,</span>
    <span class="s1">&#39;mae&#39;</span><span class="p">:</span> <span class="n">mean_absolute_error</span><span class="p">,</span>
    <span class="s1">&#39;mape&#39;</span><span class="p">:</span> <span class="n">mean_absolute_percentage_error</span><span class="p">,</span>
    <span class="s1">&#39;mse&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
    <span class="s1">&#39;rmse&#39;</span><span class="p">:</span> <span class="n">rmse</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="define-functions-to-fit-and-evaluate-models-for-all-cpi-categories-validation">
<h1>Define Functions to Fit and Evaluate Models for All CPI Categories (Validation)<a class="headerlink" href="#define-functions-to-fit-and-evaluate-models-for-all-cpi-categories-validation" title="Permalink to this heading">#</a></h1>
<p>The following function will fit and evaluate a Prophet model for a single food price category using the specified training and validation dates</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fit_eval_forecast_model</span><span class="p">(</span><span class="n">foodprice_df</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">train_dates</span><span class="p">,</span> <span class="n">valid_dates</span><span class="p">):</span>
    <span class="n">train_df</span> <span class="o">=</span> <span class="n">get_prophet_df</span><span class="p">(</span><span class="n">foodprice_df</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">train_dates</span><span class="p">)</span>     <span class="c1"># Select training data.</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">()</span>                                                       <span class="c1"># Initialize model with (default) paramters.</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>                                                     <span class="c1"># Fit the model.</span>
    <span class="n">valid_df</span> <span class="o">=</span> <span class="n">get_prophet_df</span><span class="p">(</span><span class="n">foodprice_df</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">valid_dates</span><span class="p">)</span>     <span class="c1"># Select the validation data.</span>
    <span class="n">valid_forecast</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_df</span><span class="p">[[</span><span class="s1">&#39;ds&#39;</span><span class="p">]])</span>                        <span class="c1"># Produce the validation period forecast.</span>

    <span class="n">valid_metrics</span> <span class="o">=</span> <span class="p">{</span><span class="n">metric_name</span><span class="p">:</span> <span class="n">metric_fn</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">valid_df</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>              <span class="c1"># Compute validation metrics.</span>
                                      <span class="n">y_pred</span><span class="o">=</span><span class="n">valid_forecast</span><span class="o">.</span><span class="n">yhat</span><span class="p">)</span> <span class="k">for</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">metric_fn</span> <span class="ow">in</span> <span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">valid_forecast</span><span class="p">,</span> <span class="n">valid_metrics</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_valid_forecast</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">sim_forecast_date</span><span class="p">,</span> <span class="n">valid_forecast</span><span class="p">,</span> <span class="n">valid_actual</span><span class="p">):</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">valid_forecast</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">valid_actual</span><span class="o">.</span><span class="n">ds</span><span class="p">,</span> <span class="n">valid_actual</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual CPI&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;CPI Forecast (Simulated From </span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s1">) - </span><span class="si">{</span><span class="n">food_category</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;CPI (</span><span class="si">% o</span><span class="s1">f 2002 Baseline)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>

    <span class="c1">### Creating legend elements</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;tab10&quot;</span><span class="p">)</span>
    <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">actual_patch</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Historical CPI&#39;</span><span class="p">)</span>
    <span class="n">fc_patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted CPI Uncertainty&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">fc_line</span> <span class="o">=</span> <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted CPI&#39;</span><span class="p">)</span>
    <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">actual_patch</span><span class="p">)</span>
    <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fc_line</span><span class="p">)</span>
    <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fc_patch</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">/fc_valid_</span><span class="si">{</span><span class="n">food_category</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">sim_forecast_date</span><span class="si">}</span><span class="s2">.svg&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">/fc_valid_</span><span class="si">{</span><span class="n">food_category</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">sim_forecast_date</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="run-model-fitting-and-evaluation">
<h2>Run model fitting and evaluation<a class="headerlink" href="#run-model-fitting-and-evaluation" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_valid_metrics</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">all_forecasts</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">food_category</span> <span class="ow">in</span> <span class="n">foodprice_categories</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterate over each of the food price categories.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">annual_valid_metrics</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">annual_forecasts</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">cutoff_dates</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterate over each of the cutoff dates.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">train_dates</span> <span class="o">=</span> <span class="n">sim_train_dates</span><span class="p">[</span><span class="n">date</span><span class="p">]</span>
        <span class="n">valid_dates</span> <span class="o">=</span> <span class="n">sim_valid_dates</span><span class="p">[</span><span class="n">date</span><span class="p">]</span>

        <span class="n">model</span><span class="p">,</span> <span class="n">valid_forecast</span><span class="p">,</span> <span class="n">valid_metrics</span> <span class="o">=</span> <span class="n">fit_eval_forecast_model</span><span class="p">(</span><span class="n">foodprice_df</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">train_dates</span><span class="p">,</span> <span class="n">valid_dates</span><span class="p">)</span>
        <span class="n">valid_actual</span> <span class="o">=</span> <span class="n">get_prophet_df</span><span class="p">(</span><span class="n">foodprice_df</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">valid_dates</span><span class="p">)</span>

        <span class="n">plot_valid_forecast</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">valid_forecast</span><span class="p">,</span> <span class="n">valid_actual</span><span class="p">)</span>
        <span class="n">valid_metrics_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">valid_metrics</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">valid_metrics_series</span><span class="p">)</span>

        <span class="n">annual_valid_metrics</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_metrics_series</span>
        <span class="n">annual_forecasts</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_forecast</span><span class="o">.</span><span class="n">yhat</span>

    <span class="n">all_valid_metrics</span><span class="p">[</span><span class="n">food_category</span><span class="p">]</span> <span class="o">=</span> <span class="n">annual_valid_metrics</span>
    <span class="n">all_forecasts</span><span class="p">[</span><span class="n">food_category</span><span class="p">]</span> <span class="o">=</span> <span class="n">annual_forecasts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/q02bjdu1.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/q5mx9mo7.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=60071&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/q02bjdu1.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/q5mx9mo7.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelk7brjalz/prophet_model-20230802195052.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:50:52 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
19:50:52 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/b3194216e3d96852bf2c266fd883210999d712e314f716a637d05d14ffe5ffc9.png" src="../_images/b3194216e3d96852bf2c266fd883210999d712e314f716a637d05d14ffe5ffc9.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/bm_apti8.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/qasuqs6a.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=59155&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/bm_apti8.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/qasuqs6a.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modele30agcll/prophet_model-20230802195054.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:50:54 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
19:50:54 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -4.822
mae          4.653
mape         0.031
mse         33.645
rmse         5.800
dtype: float64
</pre></div>
</div>
<img alt="../_images/f74c4fe882e7a8144ac8b761a276825ea9ffa181b2c44d48ccf331542ca46039.png" src="../_images/f74c4fe882e7a8144ac8b761a276825ea9ffa181b2c44d48ccf331542ca46039.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/354aso93.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/vown1mo6.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=42138&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/354aso93.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/vown1mo6.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelfnsvk_5v/prophet_model-20230802195056.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:50:56 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
19:50:56 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -43.735
mae          8.556
mape         0.057
mse         76.110
rmse         8.724
dtype: float64
</pre></div>
</div>
<img alt="../_images/b3ff397d3a8c7faf9e9bc8bb662dd640830304a5b87aef9bb95fdfd11c46870d.png" src="../_images/b3ff397d3a8c7faf9e9bc8bb662dd640830304a5b87aef9bb95fdfd11c46870d.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/xzvwvtms.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/t82bi_7e.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=75658&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/xzvwvtms.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/t82bi_7e.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model7tsfcn7_/prophet_model-20230802195057.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:50:57 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -25.066
mae          5.099
mape         0.034
mse         26.958
rmse         5.192
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:50:58 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/c344f25a32fa3295bb373c80703359ddd4a73088cec4f3571f3b6117bd159eea.png" src="../_images/c344f25a32fa3295bb373c80703359ddd4a73088cec4f3571f3b6117bd159eea.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/ftxz8w0s.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/upmzvzaq.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=4756&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/ftxz8w0s.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/upmzvzaq.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modeltwbm3tai/prophet_model-20230802195100.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:00 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.277
mae         1.408
mape        0.009
mse         2.887
rmse        1.699
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:00 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/ea13efce2bfa06a1999dde1fbe2abeea12c8d2c2eb8e42034d89b8901b6a0aad.png" src="../_images/ea13efce2bfa06a1999dde1fbe2abeea12c8d2c2eb8e42034d89b8901b6a0aad.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/o_j8rvku.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/dan0et4n.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=71290&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/o_j8rvku.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/dan0et4n.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelm3v5zp_l/prophet_model-20230802195103.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:03 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -4.506
mae          3.587
mape         0.023
mse         15.091
rmse         3.885
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:03 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/a5c9199c78a0d1b3829365ebab7368aa5b4c8a8c79eeb723199eea1886eda979.png" src="../_images/a5c9199c78a0d1b3829365ebab7368aa5b4c8a8c79eeb723199eea1886eda979.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/z7ne6vye.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/i1ue_s6d.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=7199&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/z7ne6vye.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/i1ue_s6d.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model7m8j7jzg/prophet_model-20230802195104.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:04 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -1.144
mae         1.667
mape        0.011
mse         3.892
rmse        1.973
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:05 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/4d826052e6617e1a71d22549999d9e4828337633377fd4ece30189402a212b25.png" src="../_images/4d826052e6617e1a71d22549999d9e4828337633377fd4ece30189402a212b25.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/1uyrkjsx.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/p7tpwx36.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=11715&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/1uyrkjsx.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/p7tpwx36.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_models10mvefi/prophet_model-20230802195106.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:06 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -6.643
mae          3.148
mape         0.023
mse         12.866
rmse         3.587
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:06 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/6d8731275dffda1143faa2d7871a0cdbed0e103d2a57b3d667470f989a2ad006.png" src="../_images/6d8731275dffda1143faa2d7871a0cdbed0e103d2a57b3d667470f989a2ad006.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/x9zk6f1k.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/g1na1yu2.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=98191&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/x9zk6f1k.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/g1na1yu2.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelafgkz0hm/prophet_model-20230802195108.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:08 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -29.866
mae          4.629
mape         0.035
mse         22.608
rmse         4.755
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:08 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/68251c1d4732618f5d30240b6d4fb3464e8b7ad6d71dab947f58374492563ccb.png" src="../_images/68251c1d4732618f5d30240b6d4fb3464e8b7ad6d71dab947f58374492563ccb.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/c82dux91.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/pwpzxk9t.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=49261&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/c82dux91.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/pwpzxk9t.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelf7hqj3wu/prophet_model-20230802195110.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:10 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -8.021
mae         2.391
mape        0.018
mse         6.375
rmse        2.525
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:10 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/55448d421984421e46a18f2d8a6bee9a8ce3070ee37ee3964c3aa7cadd5f3e5d.png" src="../_images/55448d421984421e46a18f2d8a6bee9a8ce3070ee37ee3964c3aa7cadd5f3e5d.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/dtck5k2l.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/pm27hpb8.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=8631&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/dtck5k2l.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/pm27hpb8.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modeluh420up0/prophet_model-20230802195112.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:12 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -2.502
mae         2.373
mape        0.017
mse         7.726
rmse        2.780
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:12 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/ca4ae8e0c0409dc64eba98d3527cf7146dace03c0fcc898e67e5b4e5327992ff.png" src="../_images/ca4ae8e0c0409dc64eba98d3527cf7146dace03c0fcc898e67e5b4e5327992ff.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/lfvrzbho.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/7e55swfl.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=32222&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/lfvrzbho.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/7e55swfl.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model9_32ozgi/prophet_model-20230802195114.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:14 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -7.823
mae          5.749
mape         0.041
mse         37.121
rmse         6.093
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:14 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/635bbbe2cfd0c42cc4b6930f7a1ac9e0aa8487148cf460584f69437762c7f5f8.png" src="../_images/635bbbe2cfd0c42cc4b6930f7a1ac9e0aa8487148cf460584f69437762c7f5f8.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/xzl69n1n.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/j4drmnxp.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=29164&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/xzl69n1n.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/j4drmnxp.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelvh64hq9r/prophet_model-20230802195117.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:17 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -7.844
mae          7.416
mape         0.051
mse         61.188
rmse         7.822
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:17 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/2ac5f27dd7bcdc43fee205a1163ad44e26c13991e3619dd774bfd871f8db280c.png" src="../_images/2ac5f27dd7bcdc43fee205a1163ad44e26c13991e3619dd774bfd871f8db280c.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/s95jvljs.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/e5wvnq12.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=57291&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/s95jvljs.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/e5wvnq12.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modeleu7zeu26/prophet_model-20230802195119.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:19 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -1.023
mae          3.493
mape         0.027
mse         14.548
rmse         3.814
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:19 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/b2a114aa1fb57e719946c9f281138a0a9757675147486d0d2543bb7deb18d7c6.png" src="../_images/b2a114aa1fb57e719946c9f281138a0a9757675147486d0d2543bb7deb18d7c6.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/koisrjgn.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/gzod0fv4.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=82770&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/koisrjgn.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/gzod0fv4.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelvfwygerm/prophet_model-20230802195121.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:21 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -0.812
mae          2.994
mape         0.022
mse         11.006
rmse         3.318
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:21 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/9ffd271b0e7bf7515d064e2a7d0fe568b900cf49be59c8ae3ec5c10372647203.png" src="../_images/9ffd271b0e7bf7515d064e2a7d0fe568b900cf49be59c8ae3ec5c10372647203.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/3mjne23y.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/90v92v7k.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=80570&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/3mjne23y.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/90v92v7k.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelbcl2opyy/prophet_model-20230802195123.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:23 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.227
mae         1.082
mape        0.008
mse         2.082
rmse        1.443
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:23 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/db3842f1967cfdc6d24ef168b38a3dd76aecf94eae7af80eeca29a23fad11a7e.png" src="../_images/db3842f1967cfdc6d24ef168b38a3dd76aecf94eae7af80eeca29a23fad11a7e.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/wiau0w4g.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/ezndynf8.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=92084&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/wiau0w4g.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/ezndynf8.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelgz8luo51/prophet_model-20230802195124.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:24 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.282
mae         1.749
mape        0.013
mse         4.710
rmse        2.170
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:24 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/bb2da72b3f1b90ef8708e603b7a70936179a140102eef0fcab1894429ba7a66d.png" src="../_images/bb2da72b3f1b90ef8708e603b7a70936179a140102eef0fcab1894429ba7a66d.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/doagfu8e.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/rafn19fx.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=43733&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/doagfu8e.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/rafn19fx.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelzhlvod6j/prophet_model-20230802195126.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:26 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
19:51:26 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -2.420
mae         2.422
mape        0.017
mse         8.912
rmse        2.985
dtype: float64
</pre></div>
</div>
<img alt="../_images/c6efc6f590f686bd0c02a66ad9cbd723c3d3d06276a9bc1b9c0269657f1c903e.png" src="../_images/c6efc6f590f686bd0c02a66ad9cbd723c3d3d06276a9bc1b9c0269657f1c903e.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/7akva3_8.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/fj2wmios.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=72882&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/7akva3_8.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/fj2wmios.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelakfpw2wi/prophet_model-20230802195128.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:28 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -6.321
mae          4.360
mape         0.030
mse         20.604
rmse         4.539
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:28 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/8c96b0f24ab8e311747b9a9f9592a48ce41a8d922d72592673318e7ab3e0e021.png" src="../_images/8c96b0f24ab8e311747b9a9f9592a48ce41a8d922d72592673318e7ab3e0e021.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/mw3b9f51.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/hvc6bfpg.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=76875&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/mw3b9f51.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/hvc6bfpg.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelv3xvhows/prophet_model-20230802195131.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:31 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.550
mae         0.971
mape        0.007
mse         1.022
rmse        1.011
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:31 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/416ab9383f157a501cac702a97ec0951d7430ce3daa4259f45de1c8866e9a0fb.png" src="../_images/416ab9383f157a501cac702a97ec0951d7430ce3daa4259f45de1c8866e9a0fb.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/zg2knqgv.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/_khevk89.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=54956&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/zg2knqgv.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/_khevk89.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelzddhi08n/prophet_model-20230802195133.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:33 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.297
mae         1.429
mape        0.010
mse         2.456
rmse        1.567
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:33 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/4d00be0b8583409e56a33af3eadace63541a690ed8286d871440b84f490bbfa5.png" src="../_images/4d00be0b8583409e56a33af3eadace63541a690ed8286d871440b84f490bbfa5.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/h1osocxk.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/jdllv_a8.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=73472&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/h1osocxk.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/jdllv_a8.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelcjstmx6a/prophet_model-20230802195135.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:35 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -1.008
mae          3.467
mape         0.023
mse         13.892
rmse         3.727
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:35 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/f85dada07bab5c451b474b50c25f01b75c685977baeac579eabb7c80f2302408.png" src="../_images/f85dada07bab5c451b474b50c25f01b75c685977baeac579eabb7c80f2302408.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/ndeuz8p3.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/g7w5q2nd.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=47725&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/ndeuz8p3.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/g7w5q2nd.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model1ccxx05y/prophet_model-20230802195138.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:38 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -3.000
mae          3.434
mape         0.022
mse         11.949
rmse         3.457
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:38 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/212c25bcdc3533bd8afdb451c51b0f9636512c6fe38f2c9bf21eea865944aeef.png" src="../_images/212c25bcdc3533bd8afdb451c51b0f9636512c6fe38f2c9bf21eea865944aeef.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/6yb08mig.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/xls6r0_9.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=76543&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/6yb08mig.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/xls6r0_9.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelcvb5sba4/prophet_model-20230802195140.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:40 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.142
mae         1.448
mape        0.009
mse         2.245
rmse        1.498
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:40 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/9ec704515950b07aa0bb3f7989f8c07d5f124051706f88429d82719ca58128c5.png" src="../_images/9ec704515950b07aa0bb3f7989f8c07d5f124051706f88429d82719ca58128c5.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/5u1a2aj4.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/280jt_83.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=16173&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/5u1a2aj4.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/280jt_83.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelh63iis4_/prophet_model-20230802195142.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:42 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.845
mae         0.511
mape        0.003
mse         0.564
rmse        0.751
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:42 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/2ed3b7efacde47743644b08560885ef830e5f90427d42a6067e1c6e8ee6154ad.png" src="../_images/2ed3b7efacde47743644b08560885ef830e5f90427d42a6067e1c6e8ee6154ad.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/zozy6udk.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/gufao3j4.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=51883&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/zozy6udk.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/gufao3j4.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelakckb9qn/prophet_model-20230802195144.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:44 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.856
mae         1.893
mape        0.013
mse         4.725
rmse        2.174
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:44 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/43c4401d224dd0c14f28f48a022f87848fd3b60bee77e3190f9ebefe465185f1.png" src="../_images/43c4401d224dd0c14f28f48a022f87848fd3b60bee77e3190f9ebefe465185f1.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/i5xxtnq5.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/q6cb8bsq.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=26184&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/i5xxtnq5.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/q6cb8bsq.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model7fzxyyba/prophet_model-20230802195147.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:47 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -6.406
mae          3.521
mape         0.025
mse         12.889
rmse         3.590
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:47 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/c22a59ea7b328eb99d3f66c91193398c24947a1c63a8697b4cb400316ddb38a2.png" src="../_images/c22a59ea7b328eb99d3f66c91193398c24947a1c63a8697b4cb400316ddb38a2.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/h0srpbke.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/2cm1t5mu.json
DEBUG:cmdstanpy:idx 0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -1.103
mae         2.358
mape        0.016
mse         5.911
rmse        2.431
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=49378&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/h0srpbke.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/2cm1t5mu.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modeldiotegoz/prophet_model-20230802195150.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:50 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
19:51:51 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/9d9a46a9e1c5ecd3ef5fc8dd7fcebc50e51b647d047561fb89f2f77a81cb7c4c.png" src="../_images/9d9a46a9e1c5ecd3ef5fc8dd7fcebc50e51b647d047561fb89f2f77a81cb7c4c.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/1grayn9_.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/z34f9ac2.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=63016&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/1grayn9_.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/z34f9ac2.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model5hklo66k/prophet_model-20230802195153.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:53 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.673
mae         1.242
mape        0.008
mse         1.926
rmse        1.388
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:53 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/81cfa7570e0795879166c7c4179fe692961de5cc05c1afc2fccf629922e55bfe.png" src="../_images/81cfa7570e0795879166c7c4179fe692961de5cc05c1afc2fccf629922e55bfe.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/82vhj4ah.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/6p6w5u_g.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=26381&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/82vhj4ah.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/6p6w5u_g.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelu6co_a08/prophet_model-20230802195155.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:55 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.662
mae         1.900
mape        0.012
mse         3.894
rmse        1.973
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:51:55 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/891f8857b2830985485e2cc0da9f7fc14bda2072a9f6ddefbf04acc854addff0.png" src="../_images/891f8857b2830985485e2cc0da9f7fc14bda2072a9f6ddefbf04acc854addff0.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/brzxpre1.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/kc5b_g06.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=24757&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/brzxpre1.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/kc5b_g06.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelgmpmogwq/prophet_model-20230802195157.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:57 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
19:51:57 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.255
mae         1.307
mape        0.008
mse         2.893
rmse        1.701
dtype: float64
</pre></div>
</div>
<img alt="../_images/977c0b829569e9e8683d0d42f362d1120ec239db20767097e844046f945ad142.png" src="../_images/977c0b829569e9e8683d0d42f362d1120ec239db20767097e844046f945ad142.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/bqd863hk.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/vicddoq5.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=41389&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/bqd863hk.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/vicddoq5.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelpd40jfn5/prophet_model-20230802195159.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:51:59 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
19:51:59 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -1.236
mae          5.637
mape         0.041
mse         57.054
rmse         7.553
dtype: float64
</pre></div>
</div>
<img alt="../_images/6a52bb1800ecf7e1a8f87ebac8c7b59607dc35b604c3b5201c5f1e2bdef737cd.png" src="../_images/6a52bb1800ecf7e1a8f87ebac8c7b59607dc35b604c3b5201c5f1e2bdef737cd.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/uuanp3rs.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/r72c73gm.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=28535&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/uuanp3rs.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/r72c73gm.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelbiqfscqw/prophet_model-20230802195201.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:01 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -2.666
mae          5.878
mape         0.045
mse         40.181
rmse         6.339
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:01 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/379404c05fa415f3cc71258f20746f348a48625112ba8f0288accec77396b151.png" src="../_images/379404c05fa415f3cc71258f20746f348a48625112ba8f0288accec77396b151.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/im8hpmvr.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/5n4mypqa.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=47250&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/im8hpmvr.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/5n4mypqa.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelc7tfzxnt/prophet_model-20230802195204.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:04 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
19:52:04 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -4.835
mae          6.835
mape         0.052
mse         51.328
rmse         7.164
dtype: float64
</pre></div>
</div>
<img alt="../_images/b2e6dcb20591a35b2166c928afebad2150ce37a96e6a6a250ce456b5bdba2466.png" src="../_images/b2e6dcb20591a35b2166c928afebad2150ce37a96e6a6a250ce456b5bdba2466.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/tgzj0fjy.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/sz1fmiof.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=37754&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/tgzj0fjy.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/sz1fmiof.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelz_q35fpe/prophet_model-20230802195206.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:06 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
19:52:06 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -1.144
mae          4.655
mape         0.035
mse         28.311
rmse         5.321
dtype: float64
</pre></div>
</div>
<img alt="../_images/cc30564fb45ceb4cdb14bafb162ee2456ab474865ab5efffe2bd9a74a4fb3644.png" src="../_images/cc30564fb45ceb4cdb14bafb162ee2456ab474865ab5efffe2bd9a74a4fb3644.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/2yt6ggzc.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/361bwasl.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=72664&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/2yt6ggzc.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/361bwasl.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model9vc74cvj/prophet_model-20230802195208.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:08 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -1.044
mae          3.786
mape         0.027
mse         17.293
rmse         4.158
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:08 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/5b2893565d637c0305637b51016ffe362370860bbe888b2b52a7d8e31a484f13.png" src="../_images/5b2893565d637c0305637b51016ffe362370860bbe888b2b52a7d8e31a484f13.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/l04h6c0x.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/ayud6qu4.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=13627&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/l04h6c0x.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/ayud6qu4.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model42muwajc/prophet_model-20230802195210.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:10 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.350
mae         1.518
mape        0.011
mse         3.597
rmse        1.897
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:10 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/1cde4ee78fbe08a8c1fe455beae8d872964ed3cccded9903dc0d6c6776263895.png" src="../_images/1cde4ee78fbe08a8c1fe455beae8d872964ed3cccded9903dc0d6c6776263895.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/0bdc5rmy.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/ct5va66q.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=31363&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/0bdc5rmy.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/ct5va66q.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model521vxk8n/prophet_model-20230802195212.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:12 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -5.708
mae          3.503
mape         0.022
mse         15.226
rmse         3.902
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:12 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/1e34c8e5ddb135a656c2d11118e63a833b08b4a4d952bf5c28c74b05ee9c3a78.png" src="../_images/1e34c8e5ddb135a656c2d11118e63a833b08b4a4d952bf5c28c74b05ee9c3a78.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/c_rv4vxl.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/j85m9r6x.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=66854&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/c_rv4vxl.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/j85m9r6x.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model17x5kiki/prophet_model-20230802195214.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:14 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -41.032
mae          9.085
mape         0.058
mse         88.698
rmse         9.418
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:14 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/e07bc872ecf23ae1e7232a1597f05767d867e3c73d574f460d8fb8b297ffd65f.png" src="../_images/e07bc872ecf23ae1e7232a1597f05767d867e3c73d574f460d8fb8b297ffd65f.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/oyzc39r3.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/q47lqimq.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=42633&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/oyzc39r3.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/q47lqimq.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modeltz_g820l/prophet_model-20230802195216.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:16 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -79.406
mae          10.533
mape          0.067
mse         116.601
rmse         10.798
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:16 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/b22d58223a2457022ac2e402e380dd23eaf95e65e1fc2741a32100f952dcd94f.png" src="../_images/b22d58223a2457022ac2e402e380dd23eaf95e65e1fc2741a32100f952dcd94f.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/k2g0kalt.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/cjtxojkm.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=90941&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/k2g0kalt.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/cjtxojkm.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model59nce7h8/prophet_model-20230802195219.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:19 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -2.302
mae          7.202
mape         0.045
mse         56.183
rmse         7.496
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:19 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/94bbcc6088f8f75d97bfbf76028a0b68f476d561b8af247460f5fbe41634b084.png" src="../_images/94bbcc6088f8f75d97bfbf76028a0b68f476d561b8af247460f5fbe41634b084.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/2t42uffl.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/ed3wwcsv.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=90412&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/2t42uffl.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/ed3wwcsv.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelgz_pq2b4/prophet_model-20230802195221.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:21 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.193
mae         2.099
mape        0.012
mse         6.425
rmse        2.535
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:22 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/1aa7e3489d280845ffaf291c30fb269ead3afc7ca008c8f701f494d551f26fc2.png" src="../_images/1aa7e3489d280845ffaf291c30fb269ead3afc7ca008c8f701f494d551f26fc2.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/zcwxxc3n.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/yr8xc4rs.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=15148&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/zcwxxc3n.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/yr8xc4rs.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelxuir_q8q/prophet_model-20230802195223.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:23 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score     0.451
mae          3.359
mape         0.019
mse         19.031
rmse         4.362
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:24 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/5102c17c8df8afd87493fe995032eac8312abb5565454490368f3f02f09d7294.png" src="../_images/5102c17c8df8afd87493fe995032eac8312abb5565454490368f3f02f09d7294.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/ge5vzxvi.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/1o9s1z2k.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=19159&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/ge5vzxvi.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/1o9s1z2k.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelxrhafv8w/prophet_model-20230802195225.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:25 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.788
mae         1.068
mape        0.008
mse         2.562
rmse        1.601
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:26 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/5fc91a76c9c18e5ad176da4fd9bb72eaea7841d73368b0ef20bc8684c0eb5379.png" src="../_images/5fc91a76c9c18e5ad176da4fd9bb72eaea7841d73368b0ef20bc8684c0eb5379.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/yh9g5sr5.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/0n5gwn1o.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=28096&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/yh9g5sr5.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/0n5gwn1o.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model279d6phq/prophet_model-20230802195227.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:27 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -8.228
mae         2.480
mape        0.019
mse         6.536
rmse        2.557
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:28 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/165a9ce4c03bdced822d547de9fcfc52235594e353ca648dfa63fe732d21232b.png" src="../_images/165a9ce4c03bdced822d547de9fcfc52235594e353ca648dfa63fe732d21232b.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/v6jppk_8.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/8msb41j8.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=10100&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/v6jppk_8.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/8msb41j8.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model78bcbnhf/prophet_model-20230802195230.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:30 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -7.504
mae         1.909
mape        0.014
mse         4.159
rmse        2.039
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:30 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/3e249ee07c6ad5bbed918ddb18aea1067c2d784c9134ecc86b59dfe7fd64c0cf.png" src="../_images/3e249ee07c6ad5bbed918ddb18aea1067c2d784c9134ecc86b59dfe7fd64c0cf.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/shczyujt.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/x641zs5i.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=48117&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/shczyujt.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/x641zs5i.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelw77airla/prophet_model-20230802195232.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:32 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    0.472
mae         0.939
mape        0.007
mse         1.392
rmse        1.180
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:32 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/7bb7fda488b46bc7956243123cf8008d5d61829b855af29ec4dc06bcb5df3ca1.png" src="../_images/7bb7fda488b46bc7956243123cf8008d5d61829b855af29ec4dc06bcb5df3ca1.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/rvhwkn52.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/j7dsk1yl.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=2912&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/rvhwkn52.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/j7dsk1yl.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model3sa7vwxh/prophet_model-20230802195235.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:35 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.922
mae         1.385
mape        0.010
mse         2.364
rmse        1.537
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:35 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/f01114a02bec765d091bd8934f942517db098762c680e05d6882c3a75b8dc2d1.png" src="../_images/f01114a02bec765d091bd8934f942517db098762c680e05d6882c3a75b8dc2d1.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/3wugdwzu.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/68pe7dij.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=46706&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/3wugdwzu.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/68pe7dij.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model51fadfpa/prophet_model-20230802195237.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:37 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
19:52:38 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score   -0.313
mae         2.344
mape        0.017
mse         9.013
rmse        3.002
dtype: float64
</pre></div>
</div>
<img alt="../_images/00fbaea1f2230fa01b964c887856a8f72891228abe496f2fb01afdaed65f1e06.png" src="../_images/00fbaea1f2230fa01b964c887856a8f72891228abe496f2fb01afdaed65f1e06.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score     -0.303
mae           7.606
mape          0.055
mse         102.582
rmse         10.128
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/fp8edufg.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/qff86p52.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=90163&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/fp8edufg.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/qff86p52.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_model77vq27le/prophet_model-20230802195240.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:40 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
19:52:40 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/20bb56e56a1cf3bce1a567c0cf7c26bd550e3dc219d402130dfd92a6a0a69fcb.png" src="../_images/20bb56e56a1cf3bce1a567c0cf7c26bd550e3dc219d402130dfd92a6a0a69fcb.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/qwovrm6y.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/rmoklzm6.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=40449&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/qwovrm6y.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/rmoklzm6.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelymkgeozn/prophet_model-20230802195242.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:42 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
19:52:42 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score     0.562
mae          2.937
mape         0.022
mse         13.200
rmse         3.633
dtype: float64
</pre></div>
</div>
<img alt="../_images/6e2ad6feb46bc10f677d20680eb79bb8a1cdd2a3d3c8967c6f3cb012ec4fd152.png" src="../_images/6e2ad6feb46bc10f677d20680eb79bb8a1cdd2a3d3c8967c6f3cb012ec4fd152.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/fmimwo_l.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/36yfe95k.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=20804&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/fmimwo_l.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/36yfe95k.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelcu8pchgy/prophet_model-20230802195244.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:44 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score     0.569
mae          3.643
mape         0.026
mse         23.609
rmse         4.859
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:44 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/b8488d1bd41c2d22cd00f6055a3125075770f80f61583ddbbc3ea9de44db93dd.png" src="../_images/b8488d1bd41c2d22cd00f6055a3125075770f80f61583ddbbc3ea9de44db93dd.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/foz4yb_x.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/_152euyy.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=70493&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/foz4yb_x.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/_152euyy.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelyejf_rd8/prophet_model-20230802195246.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:46 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score     -0.758
mae          11.216
mape          0.073
mse         144.866
rmse         12.036
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:46 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/030a851641295bd2fb47258c1f0f6304ab9ebe31a28972339b852756a54d6778.png" src="../_images/030a851641295bd2fb47258c1f0f6304ab9ebe31a28972339b852756a54d6778.png" />
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:prophet:Disabling weekly seasonality. Run prophet with weekly_seasonality=True to override this.
INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/0r8xsa0e.json
DEBUG:cmdstanpy:input tempfile: /tmp/tmp7f_z_j0i/3ow2ba9d.json
DEBUG:cmdstanpy:idx 0
DEBUG:cmdstanpy:running CmdStan, num_threads: None
DEBUG:cmdstanpy:CmdStan args: [&#39;/usr/local/lib/python3.10/dist-packages/prophet/stan_model/prophet_model.bin&#39;, &#39;random&#39;, &#39;seed=49047&#39;, &#39;data&#39;, &#39;file=/tmp/tmp7f_z_j0i/0r8xsa0e.json&#39;, &#39;init=/tmp/tmp7f_z_j0i/3ow2ba9d.json&#39;, &#39;output&#39;, &#39;file=/tmp/tmp7f_z_j0i/prophet_modelcz1akvxm/prophet_model-20230802195248.csv&#39;, &#39;method=optimize&#39;, &#39;algorithm=lbfgs&#39;, &#39;iter=10000&#39;]
19:52:48 - cmdstanpy - INFO - Chain [1] start processing
INFO:cmdstanpy:Chain [1] start processing
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -2.051
mae          9.434
mape         0.060
mse         95.997
rmse         9.798
dtype: float64
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19:52:48 - cmdstanpy - INFO - Chain [1] done processing
INFO:cmdstanpy:Chain [1] done processing
</pre></div>
</div>
<img alt="../_images/c124f93ee2acbc3e5dff5930cde847398d7f77126f01407ae1dd7a77ada585da.png" src="../_images/c124f93ee2acbc3e5dff5930cde847398d7f77126f01407ae1dd7a77ada585da.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r2_score    -1.252
mae          5.115
mape         0.033
mse         37.234
rmse         6.102
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-raw-evaluation-metrics">
<h2>View Raw Evaluation Metrics<a class="headerlink" href="#view-raw-evaluation-metrics" title="Permalink to this heading">#</a></h2>
<p>View all evaluation metrics for one target category, over each of the cutoff dates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">food_category</span> <span class="o">=</span> <span class="s1">&#39;Vegetables and vegetable preparations&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_valid_metrics</span><span class="p">[</span><span class="n">food_category</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">

  <div id="df-bcb3ae6d-d93a-4ef7-99af-bf21579ff188">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>r2_score</th>
      <th>mae</th>
      <th>mape</th>
      <th>mse</th>
      <th>rmse</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-07-01</th>
      <td>-0.303</td>
      <td>7.606</td>
      <td>0.055</td>
      <td>102.582</td>
      <td>10.128</td>
    </tr>
    <tr>
      <th>2016-07-01</th>
      <td>0.562</td>
      <td>2.937</td>
      <td>0.022</td>
      <td>13.200</td>
      <td>3.633</td>
    </tr>
    <tr>
      <th>2017-07-01</th>
      <td>0.569</td>
      <td>3.643</td>
      <td>0.026</td>
      <td>23.609</td>
      <td>4.859</td>
    </tr>
    <tr>
      <th>2018-07-01</th>
      <td>-0.758</td>
      <td>11.216</td>
      <td>0.073</td>
      <td>144.866</td>
      <td>12.036</td>
    </tr>
    <tr>
      <th>2019-07-01</th>
      <td>-2.051</td>
      <td>9.434</td>
      <td>0.060</td>
      <td>95.997</td>
      <td>9.798</td>
    </tr>
    <tr>
      <th>2020-07-01</th>
      <td>-1.252</td>
      <td>5.115</td>
      <td>0.033</td>
      <td>37.234</td>
      <td>6.102</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bcb3ae6d-d93a-4ef7-99af-bf21579ff188')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>



    <div id="df-b68b174e-2f08-4ee7-8b29-ea3257125813">
      <button class="colab-df-quickchart" onclick="quickchart('df-b68b174e-2f08-4ee7-8b29-ea3257125813')"
              title="Suggest charts."
              style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>
    </div>

<style>
  .colab-df-quickchart {
    background-color: #E8F0FE;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: #1967D2;
    height: 32px;
    padding: 0 0 0 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: #E2EBFA;
    box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: #174EA6;
  }

  [theme=dark] .colab-df-quickchart {
    background-color: #3B4455;
    fill: #D2E3FC;
  }

  [theme=dark] .colab-df-quickchart:hover {
    background-color: #434B5C;
    box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
    filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
    fill: #FFFFFF;
  }
</style>

    <script>
      async function quickchart(key) {
        const containerElement = document.querySelector('#' + key);
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      }
    </script>

      <script>

function displayQuickchartButton(domScope) {
  let quickchartButtonEl =
    domScope.querySelector('#df-b68b174e-2f08-4ee7-8b29-ea3257125813 button.colab-df-quickchart');
  quickchartButtonEl.style.display =
    google.colab.kernel.accessAllowed ? 'block' : 'none';
}

        displayQuickchartButton(document);
      </script>
      <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bcb3ae6d-d93a-4ef7-99af-bf21579ff188 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bcb3ae6d-d93a-4ef7-99af-bf21579ff188');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
</section>
<section id="collect-mean-validation-metrics-over-cutoff-dates-and-save-to-file">
<h2>Collect Mean Validation Metrics Over Cutoff Dates and Save to File<a class="headerlink" href="#collect-mean-validation-metrics-over-cutoff-dates-and-save-to-file" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_valid_metrics</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">food_category</span><span class="p">,</span> <span class="n">valid_scores</span> <span class="ow">in</span> <span class="n">all_valid_metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">mean_valid_metrics</span><span class="p">[</span><span class="n">food_category</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">valid_scores</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">mean_valid_metrics_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">mean_valid_metrics</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">mean_valid_metrics_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">/mean_fc_valid_metrics.csv&quot;</span><span class="p">)</span>
<span class="n">mean_valid_metrics_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">

  <div id="df-bd995723-62db-415d-bc6f-0737dbda80da">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>r2_score</th>
      <th>mae</th>
      <th>mape</th>
      <th>mse</th>
      <th>rmse</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bakery and cereal products (excluding baby food)</th>
      <td>-13.166</td>
      <td>4.162</td>
      <td>0.027</td>
      <td>26.431</td>
      <td>4.546</td>
    </tr>
    <tr>
      <th>Dairy products and eggs</th>
      <td>-10.450</td>
      <td>4.284</td>
      <td>0.031</td>
      <td>24.647</td>
      <td>4.594</td>
    </tr>
    <tr>
      <th>Fish, seafood and other marine products</th>
      <td>-1.678</td>
      <td>2.684</td>
      <td>0.019</td>
      <td>10.310</td>
      <td>3.045</td>
    </tr>
    <tr>
      <th>Food purchased from restaurants</th>
      <td>-0.362</td>
      <td>1.877</td>
      <td>0.012</td>
      <td>5.355</td>
      <td>2.002</td>
    </tr>
    <tr>
      <th>Food</th>
      <td>-1.350</td>
      <td>2.037</td>
      <td>0.014</td>
      <td>5.373</td>
      <td>2.210</td>
    </tr>
    <tr>
      <th>Fruit, fruit preparations and nuts</th>
      <td>-1.879</td>
      <td>4.718</td>
      <td>0.035</td>
      <td>32.961</td>
      <td>5.405</td>
    </tr>
    <tr>
      <th>Meat</th>
      <td>-21.301</td>
      <td>5.963</td>
      <td>0.037</td>
      <td>50.361</td>
      <td>6.418</td>
    </tr>
    <tr>
      <th>Other food products and non-alcoholic beverages</th>
      <td>-2.881</td>
      <td>1.687</td>
      <td>0.012</td>
      <td>4.338</td>
      <td>1.986</td>
    </tr>
    <tr>
      <th>Vegetables and vegetable preparations</th>
      <td>-0.539</td>
      <td>6.658</td>
      <td>0.045</td>
      <td>69.581</td>
      <td>7.759</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bd995723-62db-415d-bc6f-0737dbda80da')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>



    <div id="df-1a5540a5-eba1-460a-9f48-87c7ef81c5d4">
      <button class="colab-df-quickchart" onclick="quickchart('df-1a5540a5-eba1-460a-9f48-87c7ef81c5d4')"
              title="Suggest charts."
              style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>
    </div>

<style>
  .colab-df-quickchart {
    background-color: #E8F0FE;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: #1967D2;
    height: 32px;
    padding: 0 0 0 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: #E2EBFA;
    box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: #174EA6;
  }

  [theme=dark] .colab-df-quickchart {
    background-color: #3B4455;
    fill: #D2E3FC;
  }

  [theme=dark] .colab-df-quickchart:hover {
    background-color: #434B5C;
    box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
    filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
    fill: #FFFFFF;
  }
</style>

    <script>
      async function quickchart(key) {
        const containerElement = document.querySelector('#' + key);
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      }
    </script>

      <script>

function displayQuickchartButton(domScope) {
  let quickchartButtonEl =
    domScope.querySelector('#df-1a5540a5-eba1-460a-9f48-87c7ef81c5d4 button.colab-df-quickchart');
  quickchartButtonEl.style.display =
    google.colab.kernel.accessAllowed ? 'block' : 'none';
}

        displayQuickchartButton(document);
      </script>
      <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bd995723-62db-415d-bc6f-0737dbda80da button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bd995723-62db-415d-bc6f-0737dbda80da');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="save-validation-forecasts-to-file-optional-for-ensembling">
<h1>Save Validation Forecasts to File (Optional, For Ensembling)<a class="headerlink" href="#save-validation-forecasts-to-file-optional-for-ensembling" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date_forecasts</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">cutoff_dates</span><span class="p">:</span>
    <span class="n">valid_dates</span> <span class="o">=</span> <span class="n">sim_valid_dates</span><span class="p">[</span><span class="n">date</span><span class="p">]</span>
    <span class="n">food_forecasts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">food_category</span> <span class="ow">in</span> <span class="n">foodprice_categories</span><span class="p">:</span>
        <span class="n">food_forecasts</span><span class="p">[</span><span class="n">food_category</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_forecasts</span><span class="p">[</span><span class="n">food_category</span><span class="p">][</span><span class="n">date</span><span class="p">]</span>
    <span class="n">date_forecasts</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">food_forecasts</span><span class="p">)</span>
    <span class="n">date_forecasts</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="n">date_forecasts</span><span class="p">[</span><span class="n">date</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">valid_dates</span><span class="p">))</span>
    <span class="n">date_forecasts</span><span class="p">[</span><span class="n">date</span><span class="p">]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">/forecasts_</span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "forecasting"
        },
        kernelOptions: {
            name: "forecasting",
            path: "./demos"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'forecasting'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="demo2_pytorch_forecasting-NBEATS-CPI.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data Loading</p>
      </div>
    </a>
    <a class="right-next"
       href="README.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Univariate and Univariate With Exogenous Features Forecasting Demo Notebooks</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Rolling Cross Validation for Monthly CPI Forecasting</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data-from-file">Load Data From File</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-setup">Experiment Setup</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-function-for-prophet-data-loading">Helper Function for Prophet Data Loading</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-evaluation-metrics">Define Evaluation Metrics</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functions-to-fit-and-evaluate-models-for-all-cpi-categories-validation">Define Functions to Fit and Evaluate Models for All CPI Categories (Validation)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-model-fitting-and-evaluation">Run model fitting and evaluation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-raw-evaluation-metrics">View Raw Evaluation Metrics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#collect-mean-validation-metrics-over-cutoff-dates-and-save-to-file">Collect Mean Validation Metrics Over Cutoff Dates and Save to File</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#save-validation-forecasts-to-file-optional-for-ensembling">Save Validation Forecasts to File (Optional, For Ensembling)</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Vector Institute
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright Vector Institute.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>